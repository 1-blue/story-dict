generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// ìœ ì € ì—­í• 
enum UserRole {
  /// ê´€ë¦¬ì
  ADMIN
  /// ì¼ë¶€ ê¶Œí•œì„ ë¶€ì—¬ë°›ì€ ìœ ì €
  MANAGER
  /// ì¼ë°˜ ìœ ì €
  USER
  /// ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ì²´í—˜ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìœ ì € ( 1ì¼ )
  GUEST
}

/// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹
enum UserProvider {
  /// ì¼ë°˜ ë¡œê·¸ì¸ ( ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ )
  LOCAL
  /// ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
  KAKAO
  /// êµ¬ê¸€ ë¡œê·¸ì¸
  GOOGLE
}

/// ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬
enum PostCategory {
  /// ìƒì‹
  GENERAL_KNOWLEDGE
  /// ì–´ì›
  ETYMOLOGY
  /// ìˆœìš°ë¦¬ë§
  PURE_KOREAN
  /// ëª…ëŒ€ì‚¬
  QUOTATION
  /// ë‹¨ìˆœ ì •ë³´
  INFORMATION
  /// ë„Œì„¼ìŠ¤
  NONSENSE
}

enum ReactionType {
  /// ì¢‹ì•„ìš” ğŸ‘
  GOOD
  /// ì‹«ì–´ìš” ğŸ‘
  BAD
  /// ë¶ˆíƒ€ì˜¤ë¥´ë‹¤ ğŸ”¥
  FIRE
  /// ë³´ë‹¤ ğŸ‘€
  SEE
  /// í•˜íŠ¸ â¤ï¸
  HEART
  /// ì›ƒë‹¤ ğŸ˜Š
  SMILE
  /// ìŠ¬í”„ë‹¤ ğŸ˜¢
  SAD
  /// í™”ë‚˜ë‹¤ ğŸ˜ 
  ANGRY
  /// ë†€ëë‹¤ ğŸ«¢
  WOW
  /// ì˜ë¬¸ ğŸ¤”
  QUESTION
}

/// ìœ ì € ëª¨ë¸
model User {
  /// ìœ ì € ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ìœ ì € ì´ë©”ì¼
  email      String       @unique
  /// ìœ ì € ë¹„ë°€ë²ˆí˜¸
  password   String
  /// ìœ ì € ì†Œì§€ê¸ˆ
  money      Int          @default(1000)
  /// ìœ ì € ë‹‰ë„¤ì„
  nickname   String       @unique
  /// ìœ ì € íœ´ëŒ€í° ë²ˆí˜¸
  phone      String?      @unique
  /// ìœ ì € ì—­í• 
  role       UserRole
  /// ìœ ì € ì´ë¯¸ì§€ ê²½ë¡œ
  imagePath  String?
  /// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹
  provider   UserProvider
  /// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹ ì‹ë³„ì ( `OAuth`ì¸ ê²½ìš° ì œê³µë°›ëŠ”ê°’ )
  providerId String?      @unique

  /// [1:N] ìœ ì €ì˜ ê²Œì‹œê¸€
  posts         Post[]
  /// [1:N] ìœ ì €ì˜ ê²Œì‹œê¸€ ë°˜ì‘
  postReactions PostReaction[]

  /// [1:N] ìœ ì €ì˜ ëŒ“ê¸€
  comments         Comment[]
  /// [1:N] ìœ ì €ì˜ ëŒ“ê¸€ ë°˜ì‘
  commentReactions CommentReaction[]

  /// [1:N] ìœ ì €ì˜ ëŒ€ëŒ“ê¸€
  replies        Reply[]
  /// [1:N] ìœ ì €ì˜ ëŒ€ëŒ“ê¸€ ë°˜ì‘
  replyReactions ReplyReaction[]
}

model Post {
  /// ê²Œì‹œê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ê²Œì‹œê¸€ ì œëª©
  title         String       @unique
  /// ê²Œì‹œê¸€ ìš”ì•½
  summary       String
  /// ê²Œì‹œê¸€ ë‚´ìš©
  content       String
  /// ê²Œì‹œê¸€ ì¸ë„¤ì¼ ì´ë¯¸ì§€ ê²½ë¡œ
  thumbnailPath String?
  /// ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬
  category      PostCategory @default(GENERAL_KNOWLEDGE)

  /// [1:N] ê²Œì‹œê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ê²Œì‹œê¸€ì˜ ë°˜ì‘
  reactions PostReaction[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ“ê¸€
  comments Comment[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ€ëŒ“ê¸€
  replies Reply[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ“ê¸€ ë°˜ì‘
  commentReactions CommentReaction[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ“ê¸€ì˜ ëŒ€ëŒ“ê¸€ ë°˜ì‘
  replyReactions ReplyReaction[]
}

model PostReaction {
  /// ë°˜ì‘ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ë¦¬ì•¡ì…˜ íƒ€ì…
  type ReactionType

  /// ë°˜ì‘ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ë°˜ì‘ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String
}

model Comment {
  /// ëŒ“ê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ëŒ“ê¸€ ë‚´ìš©
  content String

  /// [1:N] ëŒ“ê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ëŒ“ê¸€ì˜ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ëŒ“ê¸€ì˜ ëŒ€ëŒ“ê¸€
  replies Reply[]

  /// [1:N] ëŒ“ê¸€ì˜ ë°˜ì‘
  reactions CommentReaction[]

  /// [1:N] ëŒ“ê¸€ì˜ ëŒ€ëŒ“ê¸€ ë°˜ì‘
  replyReactions ReplyReaction[]
}

model CommentReaction {
  /// ë°˜ì‘ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ë¦¬ì•¡ì…˜ íƒ€ì…
  type ReactionType

  /// ë°˜ì‘ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ë°˜ì‘ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ë°˜ì‘ ëŒ“ê¸€
  comment   Comment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  /// [1:N] ëŒ“ê¸€ ì‹ë³„ì
  commentId String
}

model Reply {
  /// ëŒ€ëŒ“ê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ëŒ€ëŒ“ê¸€ ë‚´ìš© 
  content String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ëŒ“ê¸€
  comment   Comment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  /// [1:N] ëŒ“ê¸€ ì‹ë³„ì
  commentId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ë°˜ì‘
  reactions ReplyReaction[]
}

model ReplyReaction {
  /// ë°˜ì‘ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ë¦¬ì•¡ì…˜ íƒ€ì…
  type ReactionType

  /// ë°˜ì‘ ìœ ì €
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ë°˜ì‘ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ë°˜ì‘ ëŒ“ê¸€
  comment   Comment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  /// [1:N] ëŒ“ê¸€ ì‹ë³„ì
  commentId String

  /// [1:N] ë°˜ì‘ ëŒ€ëŒ“ê¸€
  reply   Reply  @relation(fields: [replyId], references: [id], onDelete: Cascade)
  /// [1:N] ëŒ€ëŒ“ê¸€ ì‹ë³„ì
  replyId String
}
