generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// [í…ŒìŠ¤íŠ¸ìš©] ê³ ì–‘ì´ ëª¨ë¸
model Cat {
  /// ê³ ì–‘ì´ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ê³ ì–‘ì´ ì´ë¦„
  name   String  @unique
  /// ê³ ì–‘ì´ ë‚˜ì´
  age    Int
  /// ê³ ì–‘ì´ ì„±ë³„
  gender Boolean @default(true)
}

/// ì´ë¯¸ì§€ ì €ì¥ ìƒíƒœ
enum ImageStatus {
  /// ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•  ê¸°ë³¸ ì´ë¯¸ì§€
  DEFAULT
  /// ì„ì‹œ ì €ì¥ ( ê²Œì‹œê¸€ ì—…ë¡œë“œ ì‹œ ì¸ë„¤ì¼ ì…ë ¥ í›„ ìƒì„± ì·¨ì†Œí•œ ê²½ìš° )
  TEMP
  /// ì‹¤ì œë¡œ ì‚¬ìš©ë˜ëŠ” ì´ë¯¸ì§€
  USE
  /// ì‹¤ì œë¡œ ì‚¬ìš©ë˜ë‹¤ê°€ ì¤‘ì§€ëœ ì´ë¯¸ì§€ ( ì—…ë¡œë“œëœ ê²Œì‹œê¸€ì„ ì§€ìš´ ê²½ìš° ì¸ë„¤ì¼ ì´ë¯¸ì§€ )
  DELETED
  /// ì™¸ë¶€ì—ì„œ ì œê³µë°›ì€ ì´ë¯¸ì§€ì¸ì§€ í™•ì¸í•  ê°’ ( ë‚´ S3ì— ì—…ë¡œë“œëœ ì´ë¯¸ì§€ê°€ ì•„ë‹Œ ê²½ìš° )
  EXTERNAL
}

/// ì´ë¯¸ì§€ ì‚¬ìš© ëª©ì 
enum ImagePurpose {
  /// ìœ ì € í”„ë¡œí•„ ì´ë¯¸ì§€
  USER_PROFILE
  /// ê²Œì‹œê¸€ ì¸ë„¤ì¼ ì´ë¯¸ì§€
  POST_THUMBNAIL
}

/// ì´ë¯¸ì§€ ëª¨ë¸
model Image {
  /// ì´ë¯¸ì§€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ì´ë¯¸ì§€ URL
  url     String       @unique
  /// ì´ë¯¸ì§€ ì›ë³¸ íŒŒì¼ëª…
  name    String
  /// ì´ë¯¸ì§€ ì €ì¥ ìƒíƒœ
  status  ImageStatus  @default(TEMP)
  /// ì´ë¯¸ì§€ ì‚¬ìš© ëª©ì 
  purpose ImagePurpose @default(USER_PROFILE)

  /// [1:N] ì—°ê²°ëœ ìœ ì €
  users User[]
  /// [1:N] ì—°ê²°ëœ ê²Œì‹œê¸€
  posts Post[]
}

/// ìœ ì € ì—­í• 
enum UserRole {
  /// ê´€ë¦¬ì
  ADMIN
  /// ì¼ë¶€ ê¶Œí•œì„ ë¶€ì—¬ë°›ì€ ìœ ì €
  MANAGER
  /// ì¼ë°˜ ìœ ì €
  USER
  /// ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ì²´í—˜ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ìœ ì € ( 1ì¼ )
  GUEST
}

/// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹
enum UserProvider {
  /// ì¼ë°˜ ë¡œê·¸ì¸ ( ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ )
  LOCAL
  /// ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
  KAKAO
  /// êµ¬ê¸€ ë¡œê·¸ì¸
  GOOGLE
}

/// ìœ ì € ëª¨ë¸
model User {
  /// ìœ ì € ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ìœ ì € ì´ë©”ì¼
  email      String       @unique
  /// ìœ ì € ë¹„ë°€ë²ˆí˜¸
  password   String
  /// ìœ ì € ì†Œì§€ê¸ˆ
  money      Int          @default(1000)
  /// ìœ ì € ë‹‰ë„¤ì„
  nickname   String       @unique
  /// ìœ ì € íœ´ëŒ€í° ë²ˆí˜¸
  phone      String?      @unique
  /// ìœ ì € ì—­í• 
  role       UserRole
  /// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹
  provider   UserProvider
  /// ìœ ì € ë¡œê·¸ì¸ ë°©ì‹ ì‹ë³„ì ( `OAuth`ì¸ ê²½ìš° ì œê³µë°›ëŠ”ê°’ )
  providerId String?      @unique

  /// [1:N] ìœ ì €ì˜ ì´ë¯¸ì§€
  image   Image?  @relation(fields: [imageId], references: [id])
  /// [1:N] ì´ë¯¸ì§€ ì‹ë³„ì
  imageId String?

  /// [1:N] ìœ ì €ì˜ ê²Œì‹œê¸€
  posts Post[]

  /// [1:N] ìœ ì €ì˜ ê²Œì‹œê¸€
  reactions Reaction[]

  /// [1:N] ìœ ì €ì˜ ëŒ“ê¸€
  comments Comment[]

  /// [1:N] ìœ ì €ì˜ ëŒ€ëŒ“ê¸€
  replies Reply[]
}

/// ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬
enum PostCategory {
  /// ìƒì‹
  GENERAL_KNOWLEDGE
  /// ì–´ì›
  ETYMOLOGY
  /// ìˆœìš°ë¦¬ë§
  PURE_KOREAN
  /// ëª…ëŒ€ì‚¬
  QUOTATION
  /// ë‹¨ìˆœ ì •ë³´
  INFORMATION
  /// ë„Œì„¼ìŠ¤
  NONSENSE
}

model Post {
  /// ê²Œì‹œê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ê²Œì‹œê¸€ ì œëª©
  title       String       @unique
  /// ê²Œì‹œê¸€ ìš”ì•½
  summary     String
  /// ê²Œì‹œê¸€ ë‚´ìš©
  content     String
  /// ê²Œì‹œê¸€ ì¹´í…Œê³ ë¦¬
  category    PostCategory @default(GENERAL_KNOWLEDGE)
  /// ê²Œì‹œê¸€ ì¸ë„¤ì¼ ì´ë¯¸ì§€
  thumbnail   Image?       @relation(fields: [thumbnailId], references: [id])
  /// [1:N] ì´ë¯¸ì§€ ì‹ë³„ì
  thumbnailId String?

  /// [1:N] ê²Œì‹œê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id])
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ê²Œì‹œê¸€ì˜ ë°˜ì‘
  reactions Reaction[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ“ê¸€
  comments Comment[]

  /// [1:N] ê²Œì‹œê¸€ì˜ ëŒ€ëŒ“ê¸€
  replies Reply[]
}

enum ReactionType {
  /// ì¢‹ì•„ìš” ğŸ‘
  GOOD
  /// ì‹«ì–´ìš” ğŸ‘
  BAD
  /// ë¶ˆíƒ€ì˜¤ë¥´ë‹¤ ğŸ”¥
  FIRE
  /// ë³´ë‹¤ ğŸ‘€
  SEE
  /// í•˜íŠ¸ â¤ï¸
  HEART
  /// ì›ƒë‹¤ ğŸ˜Š
  SMILE
  /// ìŠ¬í”„ë‹¤ ğŸ˜¢
  SAD
  /// í™”ë‚˜ë‹¤ ğŸ˜ 
  ANGRY
  /// ë†€ëë‹¤ ğŸ«¢
  WOW
  /// ì˜ë¬¸ ğŸ¤”
  QUESTION
}

model Reaction {
  /// ë°˜ì‘ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ë¦¬ì•¡ì…˜ íƒ€ì…
  type ReactionType

  /// ë°˜ì‘ ìœ ì €
  user   User   @relation(fields: [userId], references: [id])
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ë°˜ì‘ ê²Œì‹œê¸€
  post   Post?   @relation(fields: [postId], references: [id])
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String?

  /// [1:N] ë°˜ì‘ ëŒ“ê¸€
  comment   Comment? @relation(fields: [commentId], references: [id])
  /// [1:N] ëŒ“ê¸€ ì‹ë³„ì
  commentId String?

  /// [1:N] ë°˜ì‘ ëŒ€ëŒ“ê¸€
  reply   Reply?  @relation(fields: [replyId], references: [id])
  /// [1:N] ëŒ€ëŒ“ê¸€ ì‹ë³„ì
  replyId String?
}

model Comment {
  /// ëŒ“ê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ëŒ“ê¸€ ë‚´ìš©
  content String

  /// [1:N] ëŒ“ê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id])
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ëŒ“ê¸€ì˜ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id])
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ëŒ“ê¸€ì˜ ëŒ€ëŒ“ê¸€
  replies Reply[]

  /// [1:N] ëŒ“ê¸€ì˜ ë°˜ì‘
  reactions Reaction[]
}

model Reply {
  /// ëŒ€ëŒ“ê¸€ ì‹ë³„ì
  id        String    @id @default(uuid())
  /// ìƒì„± ì¼ì
  createdAt DateTime  @default(now())
  /// ìˆ˜ì • ì¼ì
  updatedAt DateTime  @updatedAt
  /// ì‚­ì œ ì¼ì
  deletedAt DateTime?

  /// ëŒ€ëŒ“ê¸€ ë‚´ìš© 
  content String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ìœ ì €
  user   User   @relation(fields: [userId], references: [id])
  /// [1:N] ìœ ì € ì‹ë³„ì
  userId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ê²Œì‹œê¸€
  post   Post   @relation(fields: [postId], references: [id])
  /// [1:N] ê²Œì‹œê¸€ ì‹ë³„ì
  postId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ëŒ“ê¸€
  comment   Comment @relation(fields: [commentId], references: [id])
  /// [1:N] ëŒ“ê¸€ ì‹ë³„ì
  commentId String

  /// [1:N] ëŒ€ëŒ“ê¸€ì˜ ë°˜ì‘
  reactions Reaction[]
}
